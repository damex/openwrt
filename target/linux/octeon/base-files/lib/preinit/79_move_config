#!/bin/sh

move_config() {
	. /lib/functions.sh
	local board="$(board_name)"
	local device
	case "${board}" in
		erlite)
			device="/dev/sda1"
			;;
		itus,shield-router)
			device="/dev/mmcblk1p1"
			;;
	esac

	# checks for:
	# 1. device variable is not empty
	# 2. device variable points to actual block device
	if [ ! -z "${device}" ] && [ -b "${device}" ] ; then
		. /lib/upgrade/common.sh
		mount -t vfat "${device}" /mnt
		[ -f "/mnt/${BACKUP_FILE}" ] && mv -f "/mnt/${BACKUP_FILE}" /
		umount /mnt
	fi
	return 0
}

boot_hook_add preinit_mount_root move_config
